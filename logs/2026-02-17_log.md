# 2026-02-17 작업 로그
> 작업 시간: 11:30 ~ 12:05 (KST)

## QA 테스트 결과 (수정 전 baseline, 11:30)
| 질문 | 결과 | 소스 | 문제점 |
|---|---|---|---|
| 오버워치 겐지 | ✅ | 겐지(오버워치) | 정상 |
| 팰월드 아누비스 | ❌ "잘 모르겠어요" | - | 아누비스 데이터 파일 없음 |
| 마크 엔더드래곤 | ❌ 엔더맨 농사 정보 | 마인크래프트_농사 | 엔더드래곤 문서 없음 + 잘못된 검색 |
| 아누비스 (역질문) | ✅ | - | 게임 선택 버튼 정상 |

## 수행한 작업

### 1. 데이터 추가 (11:35~11:45)
- **엔더 드래곤**: 나무위키 크롤링 (13,773자) → 네비게이션/광고 제거 정리 (11,169자)
  - 파일: `crawler/data/minecraft/마인크래프트_엔더드래곤.txt`
  - 스탯, 개요, 패턴, 공략법, 여담 포함
- **아누비스**: palworld.gg 기반 수동 생성 (한국어 번역)
  - 파일: `crawler/data/palworld/pal_anubis.txt`
  - 기본 정보, 스탯, 스킬, 드롭, 작업 적성, 교배 조합 포함

### 2. 검색 정확도 개선 — web.py (11:45~12:00)

#### 2-1. 쿼리 동의어 매핑
- 한국어 붙여쓰기 문제 해결: "엔더드래곤" → "엔더 드래곤"
- `QUERY_SYNONYMS` 딕셔너리로 검색 전 자동 변환
- 벡터 검색에서 "엔더드래곤" 매칭 실패 → "엔더 드래곤"으로 정상 검색

#### 2-2. 질문 형태 자동 보정
- **근본 원인**: "마크 엔더드래곤" 같은 키워드만 던지면 3B 모델이 "뭘 물어보는 건지 모르겠다"로 판단
- "?", "뭐", "알려" 등 질문 마커가 없으면 자동으로 "에 대해 알려줘" 추가
- 직접 LLM 테스트로 확인: 같은 context라도 질문형이면 정답, 키워드만이면 "잘 모르겠어요"

#### 2-3. Context 품질 개선
- chunk 크기: 400자 → 600자 (더 많은 맥락 제공)
- context에 `[문서제목]` 헤더 추가 → 모델이 출처 구분 가능
- n_predict: 120 → 200 (답변 잘림 방지)

### 3. FAISS DB 리빌드 (11:50)
- 4,064 → 4,084 chunks (엔더드래곤, 아누비스 추가)
- 임베딩 모델: jhgan/ko-sroberta-multitask (변경 없음)

## QA 테스트 결과 (수정 후, 12:03)
| 질문 | 결과 | 소스 | 답변 요약 |
|---|---|---|---|
| 마크 엔더드래곤 | ✅ | 마인크래프트_엔더드래곤 | "최종 보스 비행형 몬스터, 1마리만 생성" |
| 팰월드 아누비스 | ✅ | pal_anubis, 팰월드 | "에픽등급 땅 속성, HP 120, 파트너스킬 사막의 수호자" |
| 오버워치 한조 | ✅ | 한조(오버워치) | "궁수와 암살자 능력 갖춘 영웅" |
| 아누비스 (역질문) | ✅ | - | 게임 선택 버튼 (오버워치, 팰월드) |

**결과: 2/4 → 4/4 (100% 통과)**

## 분석 및 수정 방향

### 발견된 패턴
1. **데이터 부재** → 당연히 답변 불가. 데이터 추가로 해결.
2. **벡터 검색 한계** → 한국어 붙여쓰기가 임베딩 유사도를 크게 떨어뜨림. 동의어 매핑으로 해결.
3. **3B 모델 프롬프트 민감성** → 키워드만 던지면 답변 거부, 질문형으로 바꾸면 정답. 자동 보정으로 해결.

### 향후 개선 방향
- 더 많은 동의어 매핑 추가 (게임 용어 사전)
- palworld.gg 인코딩 문제 해결 후 전체 재크롤링
- 3B 모델 training data 500+ 확대
- Minecraft/Overwatch 추가 문서 크롤링
